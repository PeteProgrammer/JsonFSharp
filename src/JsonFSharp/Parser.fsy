%{
open JsonFSharp
%}

%start start
%token <string> STRING
%token <double> DOUBLE
%token <string> EXCEPTION
%token <bool> BOOL
%token NULL
%token LBRAC RBRAC
%token EOF
%type < JsonFSharp.ParseResult > start
%%

start: 
    | value EOF { Success $1 }
    | EXCEPTION { Failure $1 }

value:
    | STRING    { JsonString $1 }
    | DOUBLE    { JsonNumber $1 }
    | BOOL      { JsonBool $1 }
    | NULL      { JsonNull }
    | LBRAC
      value
      RBRAC     { JsonArray [$2] }